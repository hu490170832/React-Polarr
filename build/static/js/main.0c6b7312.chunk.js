(this["webpackJsonpreact-learn"]=this["webpackJsonpreact-learn"]||[]).push([[0],{25:function(e,t,n){e.exports=function(){return new Worker(n.p+"8b5bcab159e1c917e266.worker.js")}},28:function(e,t,n){e.exports=n(55)},33:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"clip",use:"clip-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="clip"><defs><style></style></defs><path d="M902.978 735.755l-108.188.03V290.534c0-45.134-35.49-81.72-79.27-81.72h-26.74a37.695 37.695 0 00-2.376-.083l-293.638.082H291.61v.028l-7.15.002v-78.825h-.15l-.01-33.46c-.004-21.912-17.237-39.672-38.493-39.668-21.254.005-38.482 17.77-38.478 39.683l.01 33.445h-.01v78.847l-108.204.03c-21.254.005-38.481 17.771-38.478 39.684.005 21.911 17.238 39.672 38.494 39.668l108.188-.03v445.251c0 45.134 35.49 81.72 79.27 81.72h26.74c.786.05 1.577.083 2.376.083l293.638-.082H710.51v-.028l7.15-.002v78.825h.15l.01 33.46c.004 21.912 17.237 39.672 38.493 39.668 21.254-.005 38.482-17.77 38.478-39.683l-.01-33.445h.01v-78.847l108.204-.03c21.254-.005 38.481-17.771 38.478-39.684-.004-21.911-17.238-39.67-38.494-39.667zm-293.77.083H325.383c-20.743 0-40.92-20.966-40.92-42.35V288.193l108.451-.03h283.828c20.742 0 40.919 20.965 40.919 42.349v405.295l-108.451.03z" /></symbol>'});o.a.add(c);t.default=c},48:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"history",use:"history-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="history"><defs><style></style></defs><path d="M960 511.13a32 32 0 00-64 .12v.75c0 212.08-171.92 384-384 384S128 724.08 128 512s171.92-384 384-384c128.48 0 242.21 63.1 311.92 160H768a32 32 0 000 64h112a32 32 0 0032-32V176a32 32 0 00-64 0v39.69C765.91 122.67 645.81 64 512 64 264.58 64 64 264.58 64 512s200.58 448 448 448 448-200.58 448-448v-.87z" /><path d="M720 544a32 32 0 00-32-32H512V336a32 32 0 00-32-32 32 32 0 00-32 32v208a32 32 0 0032 32h208a32 32 0 0032-32z" /></symbol>'});o.a.add(c);t.default=c},49:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"color",use:"color-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="color"><defs><style></style></defs><path d="M505.856 918.016c-177.664 0-322.56-144.896-322.56-322.56 0-220.16 225.28-423.936 293.888-480.768 16.384-13.824 40.448-13.824 56.832 0 69.12 57.344 293.888 260.608 293.888 480.768.512 178.176-143.872 322.56-322.048 322.56zm0-755.712c-57.344 48.64-267.776 240.128-267.776 433.664 0 147.968 120.32 267.776 267.776 267.776s267.776-120.32 267.776-267.776c.512-194.048-210.432-385.536-267.776-433.664z" /><path d="M453.632 800.768c-2.56 0-5.632-.512-8.192-1.024-79.872-25.6-139.776-92.16-156.672-174.08-3.072-14.848 6.656-29.184 20.992-32.256 14.848-3.072 29.184 6.656 32.256 20.992 12.8 62.464 58.88 113.664 119.808 132.608 14.336 4.608 22.528 19.968 17.92 34.304-4.096 11.776-14.848 19.456-26.112 19.456z" /></symbol>'});o.a.add(c);t.default=c},50:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"effect",use:"effect-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="effect"><defs><style></style></defs><path d="M570.362 719.538a51.31 51.31 0 01-8.03-.635c-19.09-3.023-34.513-16.367-40.249-34.823l-41.51-133.536a10.813 10.813 0 00-7.116-7.117l-133.537-41.51c-18.456-5.737-31.8-21.16-34.824-40.249-3.023-19.09 4.901-37.881 20.681-49.041l114.174-80.743a10.81 10.81 0 004.569-8.968l-1.788-139.827c-.247-19.327 10.298-36.783 27.52-45.557 17.222-8.773 37.542-7.043 53.031 4.516l112.072 83.634a10.806 10.806 0 009.939 1.574l132.432-44.909c18.309-6.205 38.166-1.571 51.831 12.094 13.667 13.667 18.302 33.527 12.095 51.831l-44.909 132.431a10.809 10.809 0 001.574 9.94l83.634 112.073c11.56 15.49 13.29 35.811 4.515 53.032-8.673 17.022-25.831 27.521-44.892 27.521-.222 0-.443-.002-.666-.005l-139.827-1.787c-3.566.004-6.911 1.663-8.966 4.569L611.372 698.22c-9.586 13.557-24.808 21.317-41.01 21.318zm-194.07-269.146l114.975 35.74a70.802 70.802 0 0146.602 46.602l35.739 114.974 69.52-98.303c13.458-19.032 35.464-30.229 58.72-29.92l120.393 1.538-72.008-96.494a70.803 70.803 0 01-10.311-65.095l38.667-114.022-114.023 38.667a70.798 70.798 0 01-65.094-10.31l-96.495-72.009 1.539 120.391a70.804 70.804 0 01-29.921 58.722l-98.303 69.519zm408.539-223.389l-.012.035.012-.035z" /><path d="M202.764 892.016c-18.134 0-36.268-6.902-50.072-20.706v-.001c-27.61-27.609-27.61-72.535 0-100.146l203.617-203.617c13.343-13.344 31.126-20.692 50.073-20.692s36.73 7.349 50.073 20.692c27.61 27.61 27.61 72.535 0 100.146L252.837 871.309c-13.805 13.804-31.939 20.707-50.073 20.707zm-7.646-63.134c4.145 4.145 11.147 4.144 15.294 0l203.616-203.616c4.145-4.146 4.145-11.148 0-15.294-2.713-2.713-5.955-3.118-7.646-3.118s-4.934.405-7.646 3.118L195.118 813.589c-4.145 4.144-4.145 11.148 0 15.293z" /></symbol>'});o.a.add(c);t.default=c},51:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"filter",use:"filter-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="filter"><defs><style></style></defs><path d="M883.021 562.492c-24.307-55.86-68.93-98.93-125.692-121.294a233.101 233.101 0 00-25.979-8.465c14.45-50.643 11.004-104.237-10.212-153.124-24.255-55.891-68.85-98.979-125.598-121.337-56.655-22.26-118.603-21.157-174.431 3.108-55.875 24.287-98.949 68.887-121.277 125.556-11.844 29.966-17.144 61.38-15.75 93.371a227.255 227.255 0 008.457 52.369 231.224 231.224 0 00-33.299 11.541c-55.876 24.278-98.953 68.864-121.296 125.542s-21.277 118.663 3.001 174.54c24.278 55.876 68.863 98.953 125.541 121.295 27.104 10.686 55.419 16.017 83.702 16.017 30.861 0 61.683-6.35 90.839-19.018 26.927-11.7 50.87-28.127 70.964-48.34 21.933 22.188 48.432 39.683 78.14 51.396 27.115 10.683 55.431 16.014 83.717 16.012 30.886-.001 61.735-6.359 90.904-19.045 55.874-24.302 98.954-68.926 121.298-125.635 22.359-56.651 21.283-118.618-3.029-174.489zM355.645 308.959c33.954-86.177 131.726-128.725 217.928-94.855 41.797 16.468 74.656 48.213 92.524 89.389 16.89 38.92 18.486 81.895 4.691 121.814-59.563.8-116.772 25.222-158.762 67.271-21.935-22.093-48.411-39.605-78.245-51.366-26.149-10.309-53.428-15.622-80.716-15.984-13.144-37.84-12.362-78.466 2.58-116.269zm61.472 498.602c-41.178 17.892-86.856 18.676-128.625 2.211-41.768-16.465-74.624-48.21-92.515-89.387s-18.677-86.856-2.212-128.625c16.465-41.768 48.21-74.624 89.387-92.516 21.488-9.337 44.198-14.014 66.942-14.014 20.84 0 41.711 3.929 61.683 11.802 86.223 33.99 128.717 131.79 94.728 218.013-16.466 41.768-48.211 74.624-89.388 92.516zm413.116-92.594c-33.998 86.292-131.843 128.842-218.102 94.857-24.662-9.723-46.281-24.825-63.436-44.144a231.452 231.452 0 0013.629-28.631c22.342-56.678 21.276-118.663-3.002-174.54a232.257 232.257 0 00-10.647-21.399c35.022-38.823 86.709-59.716 139.17-55.231l1.275.109h.111c15.69 1.477 31.223 5.198 46.147 11.051 41.815 16.475 74.711 48.222 92.626 89.394 17.909 41.155 18.703 86.796 2.229 128.534z" /></symbol>'});o.a.add(c);t.default=c},52:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"light",use:"light-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="light"><defs><style></style></defs><path d="M512 924.605c-110.211 0-213.826-42.917-291.757-120.849-77.93-77.931-120.849-181.545-120.849-291.758 0-110.211 42.92-213.826 120.85-291.756 77.932-77.93 181.546-120.849 291.757-120.849 110.212 0 213.826 42.92 291.757 120.85s120.85 181.545 120.85 291.755c0 110.213-42.918 213.827-120.85 291.758S622.211 924.606 512 924.606zm0-798.594c-212.835 0-385.989 173.153-385.989 385.987 0 212.836 173.154 385.989 385.989 385.989s385.99-173.153 385.99-385.989c0-212.833-173.155-385.987-385.99-385.987z" /><path d="M850.062 738.367c-6.555 0-12.264-4.843-13.17-11.517l-9.5-69.912c-5.165-38.015-18.768-101.24-30.323-140.938-11.201-38.491-36.06-94.236-54.28-121.729-18.297-27.603-54.908-69.475-79.946-91.433l-47.532-41.68 17.551-20.013 47.53 41.681c26.945 23.63 64.89 67.026 84.584 96.74 19.77 29.828 45.632 87.695 57.651 128.994 11.86 40.745 25.83 105.697 31.141 144.793l9.5 69.911c.989 7.284-4.113 13.99-11.396 14.98-.61.083-1.214.123-1.81.123z" /><path d="M865.548 339.056a13.255 13.255 0 01-5.036-.995l-65.295-26.73c-35.498-14.53-97.055-34.362-137.219-44.209-38.935-9.544-99.643-15.89-132.559-13.854-33.056 2.043-87.623 12.813-119.156 23.52l-59.862 20.322c-6.96 2.364-14.519-1.362-16.88-8.323s1.363-14.518 8.322-16.88l59.863-20.323c33.934-11.52 90.489-22.682 126.07-24.882 35.724-2.204 98.763 4.33 140.54 14.57 41.225 10.105 104.46 30.484 140.965 45.428l65.295 26.73c6.802 2.784 10.06 10.556 7.275 17.358a13.32 13.32 0 01-12.323 8.268z" /><path d="M243.111 547.951l-26.106-5.19 12.33-62.004c6.99-35.15 25.602-89.708 41.487-121.622C286.77 327.1 323.953 275.77 353.71 244.71c29.359-30.644 78.626-75.22 109.824-99.366l55.796-43.182c5.812-4.499 14.17-3.435 18.67 2.38 4.498 5.812 3.433 14.17-2.38 18.67l-55.795 43.182c-30.337 23.48-78.29 66.872-106.896 96.73-27.733 28.946-63.58 78.347-78.279 107.873-14.758 29.646-32.714 82.289-39.208 114.952l-12.33 62.002z" /><path d="M399.912 786.154a13.251 13.251 0 01-8.769-3.302l-47.532-41.68c-26.948-23.632-64.893-67.028-84.584-96.74-19.769-29.826-45.633-87.694-57.652-128.994-11.86-40.752-25.829-105.706-31.14-144.792l-9.499-69.912 26.375-3.582 9.5 69.911c5.164 38.008 18.766 101.232 30.322 140.937 11.202 38.491 36.061 94.236 54.282 121.727 18.294 27.601 54.905 69.473 79.948 91.433l47.53 41.68c5.527 4.846 6.078 13.254 1.233 18.78a13.28 13.28 0 01-10.014 4.534z" /><path d="M484.856 797.726c-36.535 0-88.891-6.1-125.19-14.999-41.21-10.102-104.447-30.48-140.963-45.427l-65.295-26.73c-6.802-2.785-10.06-10.556-7.275-17.358 2.785-6.802 10.561-10.06 17.358-7.276l65.295 26.73c35.507 14.534 97.064 34.365 137.217 44.208 38.934 9.544 99.64 15.895 132.56 13.856 33.053-2.042 87.62-12.814 119.157-23.52l59.86-20.324c6.96-2.365 14.519 1.362 16.881 8.323 2.363 6.959-1.363 14.517-8.323 16.88l-59.86 20.324c-33.937 11.523-90.491 22.686-126.072 24.885-4.683.288-9.837.428-15.35.428z" /><path d="M504.672 921.836l-16.29-21.05 55.796-43.18c30.334-23.48 78.288-66.87 106.894-96.73 27.734-28.948 63.581-78.347 78.278-107.874 14.758-29.645 32.712-82.286 39.21-114.952l12.33-62.004c1.433-7.21 8.44-11.891 15.648-10.458 7.21 1.434 11.892 8.44 10.457 15.648l-12.33 62.004c-6.99 35.152-25.601 89.71-41.487 121.622-15.946 32.035-53.128 83.368-82.887 114.426-29.361 30.645-78.627 75.22-109.824 99.365l-55.795 43.183z" /></symbol>'});o.a.add(c);t.default=c},53:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"arrowLeft",use:"arrowLeft-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="arrowLeft"><defs><style></style></defs><path d="M294.134 512c0-13.701 5.232-27.402 15.667-37.847l328.704-328.694c20.91-20.91 54.804-20.91 75.704 0 20.9 20.9 20.9 54.794 0 75.705L423.363 512l290.836 290.836c20.9 20.9 20.9 54.805 0 75.705-20.9 20.91-54.794 20.91-75.704 0L309.79 549.847c-10.435-10.445-15.657-24.146-15.657-37.847z" /></symbol>'});o.a.add(c);t.default=c},54:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),c=new i.a({id:"arrowRight",use:"arrowRight-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="arrowRight"><defs><style></style></defs><path d="M729.866 512c0 13.701-5.232 27.402-15.667 37.847L385.495 878.541c-20.91 20.91-54.804 20.91-75.704 0-20.9-20.9-20.9-54.794 0-75.705L600.637 512 309.801 221.164c-20.9-20.9-20.9-54.805 0-75.705 20.9-20.91 54.794-20.91 75.704 0L714.21 474.153c10.435 10.445 15.657 24.146 15.657 37.847z" /></symbol>'});o.a.add(c);t.default=c},55:function(e,t,n){"use strict";n.r(t);var r,i,a,o,c=n(0),l=n.n(c),u=n(11),s=n.n(u),f=(n(33),n(20)),d=n.n(f),v=n(1),m=n(2),h=n(6),p=n(26),g=n(5);!function(e){e[e.IDLE=0]="IDLE",e[e.EDTING=1]="EDTING"}(r||(r={})),function(e){e[e.none=0]="none",e[e.clip=1]="clip",e[e.filter=2]="filter",e[e.light=3]="light",e[e.color=4]="color",e[e.effect=5]="effect"}(i||(i={})),function(e){e[e.updateEditStatus=0]="updateEditStatus",e[e.addLayer=1]="addLayer",e[e.updateCanvasSize=2]="updateCanvasSize",e[e.savePicture=3]="savePicture",e[e.finishSavePicture=4]="finishSavePicture"}(a||(a={})),function(e){e[e.none=0]="none",e[e.transform=1]="transform"}(o||(o={}));var b={editStatus:r.IDLE,processStatus:i.none,savePicture:!1,layers:[],width:window.innerWidth,height:window.innerHeight-92},E=function(e,t){switch(t.type){case a.updateEditStatus:return Object(g.a)(Object(g.a)({},e),{},{editStatus:t.payload});case a.addLayer:var n=t.payload;if(n.source.width/n.source.height>e.width/e.height){var r=e.width/(n.source.width/n.source.height);n.position.x1=-1,n.position.x2=1,n.position.y1=-r/e.height,n.position.y2=r/e.height,n.originPosition.x1=n.position.x1,n.originPosition.x2=n.position.x2,n.originPosition.y1=n.position.y1,n.originPosition.y2=n.position.y2}else{var i=e.height*(n.source.width/n.source.height);n.position.y1=-1,n.position.y2=1,n.position.x1=-i/e.width,n.position.x2=i/e.width,n.originPosition.x1=n.position.x1,n.originPosition.x2=n.position.x2,n.originPosition.y1=n.position.y1,n.originPosition.y2=n.position.y2}return Object(g.a)(Object(g.a)({},e),{},{layers:[].concat(Object(p.a)(e.layers),[t.payload])});case a.updateCanvasSize:return Object(g.a)(Object(g.a)({},e),{},{width:t.payload.width,height:t.payload.height});case a.savePicture:return Object(g.a)(Object(g.a)({},e),{},{savePicture:!0});case a.finishSavePicture:return Object(g.a)(Object(g.a)({},e),{},{savePicture:!1});default:return e}},w=Object(c.createContext)({state:b,dispatch:function(e){}}),x=function(e){var t=Object(c.useReducer)(E,b),n=Object(h.a)(t,2),r=n[0],i=n[1];return l.a.createElement(w.Provider,{value:{state:r,dispatch:i}},e.children)},y=function(e){var t=document.createElement("input"),n=Object(c.useContext)(w),i=(n.state,n.dispatch);t.type="file";var o=function(){if(t.files&&t.files.length){var n=t.files[0];e(n),i({type:a.updateEditStatus,payload:r.EDTING}),t.value=""}};return Object(c.useEffect)((function(){return t.onchange=o,function(){t.onchange=null}})),{input:t}};function _(){var e=Object(v.a)(["\n    min-width: 50px;\n    padding: 10px;\n"]);return _=function(){return e},e}function R(){var e=Object(v.a)(["\n    display: flex;\n    justify-content: space-between;\n    background: #111;\n"]);return R=function(){return e},e}var T=m.a.div(R()),A=m.a.div(_()),O=function(e){var t=y((function(e){console.log(e)})).input,n=Object(c.useContext)(w),r=(n.state,n.dispatch);return l.a.createElement(T,null,l.a.createElement(A,{onClick:function(){t.click()}},"\u6253\u5f00"),l.a.createElement(A,{onClick:function(){r({type:a.savePicture,payload:null})}},"\u4fdd\u5b58"))},C=n(27),F=n(24),L=n.n(F);n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(54);var j=function(e){e.name,e.children;var t=e.className,n=Object(C.a)(e,["name","children","className"]);return l.a.createElement("svg",Object.assign({className:L()("icon",t)},n),e.name&&l.a.createElement("use",{xlinkHref:"#"+e.name}))};function P(){var e=Object(v.a)(["\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    font-size: 14px;\n    .icon {\n        width: 30px;\n        height: 30px;\n        fill: #b4b3af;\n        margin-bottom: 5px;\n        &.active {\n            fill: #fff;\n        }\n        &.selected {\n            fill: #f60;\n        }\n    }\n"]);return P=function(){return e},e}var B=m.a.div(P()),S=function(e){return l.a.createElement(B,{onClick:e.onClick},l.a.createElement(j,{name:e.iconName,className:(e.isActive?"active":"")+" "+(e.isSelected?"selected":"")}),l.a.createElement("div",null,e.label))};function N(){var e=Object(v.a)(["\n    display: inline-block;\n    position: relative;\n    width: 70px;\n    height: 70px;\n    background: #f60;\n    border-radius: 5px;\n    border: 1px solid #fff;\n    &.temperature {\n        background: linear-gradient(45deg, #f60, #06f);\n    }\n    > .flex {\n        display: flex;\n        width: 100%;\n        height: 100%;\n        flex-direction: column;\n        position: relative;\n        justify-content: space-between;\n        padding: 3px;\n        > .value {\n            text-align: right;\n        }\n    }\n    > .mask {\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background: #ffffff33;\n    }\n"]);return N=function(){return e},e}var U=m.a.div(N()),D=function(e){var t=(e.min+e.max)/2,n=(e.max-e.min)/2,r=e.value>t?e.value/n:-e.value/n;return r*=100,l.a.createElement(U,{className:e.className},l.a.createElement("div",{className:"flex"},l.a.createElement("div",{className:"value"},e.value),l.a.createElement("div",null,e.label)),l.a.createElement("div",{className:"mask",style:{clipPath:e.value>t?"polygon(0% 0%, ".concat(r,"% 0%, 100% ").concat(100-r,"%, 100% 100%, 0% 0%)"):"polygon(0% 0%, 0% ".concat(r,"%, ").concat(100-r,"% 100%, 100% 100%, 0% 0%)")}}))},I=function(e,t,n){return e<t?e=t:e>n&&(e=n),e},M=function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1/0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1/0,s=function(e){e.preventDefault(),e.stopPropagation(),t&&t(e);var n=function(e){};document.addEventListener("mousemove",n),document.addEventListener("mousemove",(function e(t){r&&r(t),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e)}))},f=function(s){s.preventDefault(),s.stopPropagation(),t&&t(s);var f=e.offsetLeft,d=e.offsetTop,v=function(t){var r=t.touches[0].clientX-s.touches[0].clientX,v=t.touches[0].clientY-s.touches[0].clientY,m=o,h=l;i&&(m=~~I(r+f,o,c),e.style.left=m+"px"),a&&(h=~~I(v+d,l,u),e.style.top=h+"px"),n&&n(m,h)};document.addEventListener("touchmove",v),document.addEventListener("touchend",(function e(t){r&&r(t),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",e)}))};return e.addEventListener("mousedown",s),e.addEventListener("touchstart",f),{mousedown:s,touchstart:f}};function k(e,t,n){var r=e.createShader(t);if(r){if(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.error(e.getShaderInfoLog(r)),e.deleteShader(r)}}function z(e,t,n){var r=k(e,e.VERTEX_SHADER,t),i=k(e,e.FRAGMENT_SHADER,n);if(r&&i)return function(e,t,n){var r=e.createProgram();if(r){if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;console.error(e.getProgramInfoLog(r)),e.deleteProgram(r)}}(e,r,i)}function G(e,t,n,r,i){return[2/(t-e),0,0,0,0,2/(n-r),0,0,0,0,2/i,0,-(e+t)/(t-e),-(n+r)/(n-r),-1,1]}function Y(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function X(e,t){function n(t,n){var r=e.getUniformLocation(t,n.name),i=n.type,a=n.size>1&&"[0]"===n.name.substr(-3);if(i===e.FLOAT&&a)return function(t){e.uniform1fv(r,t)};if(i===e.FLOAT)return function(t){e.uniform1f(r,t)};if(i===e.FLOAT_VEC2)return function(t){e.uniform2fv(r,t)};if(i===e.FLOAT_VEC3)return function(t){e.uniform3fv(r,t)};if(i===e.FLOAT_VEC4)return function(t){e.uniform4fv(r,t)};if(i===e.INT&&a)return function(t){e.uniform1iv(r,t)};if(i===e.INT)return function(t){e.uniform1i(r,t)};if(i===e.INT_VEC2)return function(t){e.uniform2iv(r,t)};if(i===e.INT_VEC3)return function(t){e.uniform3iv(r,t)};if(i===e.INT_VEC4)return function(t){e.uniform4iv(r,t)};if(i===e.BOOL)return function(t){e.uniform1iv(r,t)};if(i===e.BOOL_VEC2)return function(t){e.uniform2iv(r,t)};if(i===e.BOOL_VEC3)return function(t){e.uniform3iv(r,t)};if(i===e.BOOL_VEC4)return function(t){e.uniform4iv(r,t)};if(i===e.FLOAT_MAT2)return function(t){e.uniformMatrix2fv(r,!1,t)};if(i===e.FLOAT_MAT3)return function(t){e.uniformMatrix3fv(r,!1,t)};if(i===e.FLOAT_MAT4)return function(t){e.uniformMatrix4fv(r,!1,t)};if(i===e.SAMPLER_2D||i===e.SAMPLER_CUBE)return function(){};throw new Error("unknown type: 0x"+i.toString(16))}for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a<i;++a){var o=e.getActiveUniform(t,a);if(!o)break;var c=o.name;"[0]"===c.substr(-3)&&(c=c.substr(0,c.length-3)),r[c]=n(t,o)}return r}function V(e,t){var n={};function r(t){return function(n){e.bindBuffer(e.ARRAY_BUFFER,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents,n.type||e.FLOAT,n.normalize||!1,n.stride||0,n.offset||0)}}for(var i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),a=0;a<i;++a){var o=e.getActiveAttrib(t,a);if(!o)break;var c=e.getAttribLocation(t,o.name);n[o.name]=r(c)}return n}function W(e,t){e=e.uniformSetters||e,Object.keys(t).forEach((function(n){var r=e[n];r&&r(t[n])}))}function H(e,t){e=e.attribSetters||e,Object.keys(t).forEach((function(n){var r=e[n];r&&r(t[n])}))}function q(e,t,n,r){for(var i=[],a=[],o=0;o<t;o++){var c=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,c);var l=Y(e);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,r,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,l,0),l&&a.push(l),c&&i.push(c)}return[i,a]}function Q(e,t){if(Array.isArray(t)){for(var n=0;n<t.length;n++)e.deleteFramebuffer(t[n]);t.length=0}else e.deleteFramebuffer(t)}function $(e,t){if(Array.isArray(t)){for(var n=0;n<t.length;n++)e.deleteTexture(t[n]);t.length=0}else e.deleteTexture(t)}function K(){var e=Object(v.a)(["    \n    width: 20px;\n    height: 20px;\n    background: #f60;\n    border-radius: 50%;\n    border: 2px solid #fff;\n    position: absolute;\n    top: 50%;\n    transform: translate(-10px, -50%);\n"]);return K=function(){return e},e}function J(){var e=Object(v.a)(["\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 4px;\n    background: #f60;\n    border-radius: 2px;\n"]);return J=function(){return e},e}function Z(){var e=Object(v.a)(["\n    height: 4px;\n    background: #fff;\n    border-radius: 2px;\n"]);return Z=function(){return e},e}function ee(){var e=Object(v.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    > .slider-bar {\n        flex: 1;\n        position: relative;\n        margin: 0 10px;\n    }\n    > .slider-button {\n        width: 20px;\n        height: 20px;\n        fill: #fff;\n    }\n"]);return ee=function(){return e},e}var te=m.a.div(ee()),ne=m.a.div(Z()),re=m.a.div(J()),ie=m.a.div(K()),ae=function(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(null),r=Object(c.useRef)(null),i=e.max-e.min;return Object(c.useEffect)((function(){if(t.current&&n.current&&r.current){var a=t.current,o=n.current,c=r.current,l=~~(e.value/i*o.offsetWidth);a.style.left=l+"px",c.style.width=l+"px";var u=M(a,void 0,(function(t,n){c.style.width=t+"px";var r=function(e,t){return t*Math.round(e/t)}(t/o.offsetWidth*i,e.step);e.onChange(r)}),void 0,!0,!1,0,o.offsetWidth);return function(){a.removeEventListener("mousedown",u.mousedown),a.removeEventListener("touchstart",u.touchstart)}}}),[]),l.a.createElement(te,null,l.a.createElement(j,{name:"arrowLeft",className:"slider-button"}),l.a.createElement("div",{className:"slider-bar"},l.a.createElement(ne,{ref:n}),l.a.createElement(re,{ref:r}),l.a.createElement(ie,{ref:t})),l.a.createElement(j,{name:"arrowRight",className:"slider-button"}))},oe=function(e){return l.a.createElement("div",null,l.a.createElement(ae,{onChange:function(e){},min:0,max:100,value:20,step:1}),l.a.createElement(D,{className:"temperature",value:0,min:-100,max:100,label:"\u8272\u6e29"}))};function ce(){var e=Object(v.a)(["\n    > .footer-icon {\n        display: flex;\n        justify-content: space-between;\n        background: #111;\n    }\n"]);return ce=function(){return e},e}var le=m.a.div(ce()),ue=function(){var e=Object(c.useContext)(w).state,t=Object(c.useState)([{id:1,label:"\u5386\u53f2\u8bb0\u5f55",selected:!1,iconName:"history"},{id:2,label:"\u88c1\u526a",selected:!1,iconName:"clip"},{id:3,label:"\u6ee4\u955c",selected:!1,iconName:"filter"},{id:4,label:"\u5149\u6548",selected:!1,iconName:"light"},{id:5,label:"\u8272\u5f69",selected:!0,iconName:"color"},{id:6,label:"\u7279\u6548",selected:!1,iconName:"effect"}]),n=Object(h.a)(t,2),i=n[0],a=n[1],o=i.find((function(e){return e.selected}));return l.a.createElement(le,null,l.a.createElement("div",null,o&&5===o.id?l.a.createElement(oe,null):null),l.a.createElement("div",{className:"footer-icon"},i.map((function(t){return l.a.createElement(S,{onClick:function(){return function(t){if(e.editStatus===r.EDTING){var n=i.map((function(e){return e.selected=e.id===t,e}));a(n)}}(t.id)},key:t.id,label:t.label,iconName:t.iconName,isActive:e.editStatus===r.EDTING,isSelected:t.selected})}))))},se=function(e,t,n){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1);var r=z(e,"\n    attribute vec4 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n    uniform mat4 u_projection;\n    void main () {\n        gl_Position = u_projection * a_position;\n        v_texCoord = a_texCoord;\n    }\n    ","\n    precision highp float;\n    uniform sampler2D u_texture;\n    varying vec2 v_texCoord;\n    void main () {\n        vec4 color = texture2D(u_texture, v_texCoord);\n        gl_FragColor = color;\n    }\n    ");if(!r)return{viewport:function(){},program:null};e.useProgram(r);var i=V(e,r),a=X(e,r),o={a_position:{numComponents:2,buffer:t},a_texCoord:{numComponents:2,buffer:n}},c={u_projection:G(-e.canvas.width/2,e.canvas.width/2,e.canvas.height/2,-e.canvas.height/2,1)};return H(i,o),W(a,c),{program:r,viewport:function(){c.u_projection=G(-e.canvas.width/2,e.canvas.width/2,e.canvas.height/2,-e.canvas.height/2,1),H(i,o),W(a,c)}}},fe=function(e,t,n){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1);var r=z(e,"\n    attribute vec4 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n    uniform mat4 u_projection;\n    void main () {\n        gl_Position = u_projection * a_position;\n        v_texCoord = a_texCoord;\n    }\n    ","\n    precision highp float;\n    uniform sampler2D u_texture;\n    uniform float u_temperature;\n    uniform float u_tint;\n    varying vec2 v_texCoord;\n    \n    const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);\n    const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);\n    const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);\n    void main () {\n        vec4 source = texture2D(u_texture, v_texCoord);\n        mediump vec3 yiq = RGBtoYIQ * source.rgb;\n        yiq.b = clamp(yiq.b + u_tint*0.5226*0.1, -0.5226, 0.5226);\n        lowp vec3 rgb = YIQtoRGB * yiq;\n        lowp vec3 processed = vec3(\n            (rgb.r < 0.5 ? (2.0 * rgb.r * warmFilter.r) : (1.0 - 2.0 * (1.0 - rgb.r) * (1.0 - warmFilter.r))), //adjusting temperature\n            (rgb.g < 0.5 ? (2.0 * rgb.g * warmFilter.g) : (1.0 - 2.0 * (1.0 - rgb.g) * (1.0 - warmFilter.g))), \n            (rgb.b < 0.5 ? (2.0 * rgb.b * warmFilter.b) : (1.0 - 2.0 * (1.0 - rgb.b) * (1.0 - warmFilter.b))));\n        gl_FragColor = vec4(mix(rgb, processed, u_temperature), source.a);\n    }\n    ");if(!r)return{viewport:function(){},program:null,setColor:function(){}};e.useProgram(r);var i=V(e,r),a=X(e,r),o={a_position:{numComponents:2,buffer:t},a_texCoord:{numComponents:2,buffer:n}},c={u_projection:G(-e.canvas.width/2,e.canvas.width/2,e.canvas.height/2,-e.canvas.height/2,1),u_temperature:0,u_tint:0};return H(i,o),W(a,c),{program:r,viewport:function(){c.u_projection=G(-e.canvas.width/2,e.canvas.width/2,e.canvas.height/2,-e.canvas.height/2,1),H(i,o),W(a,c)},setColor:function(e,t){e=40*e+4e3,c.u_temperature=e<5e3?4e-4*(e-5e3):6e-5*(e-5e3),W(a,c)}}},de=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.canvas.width,r=e.canvas.height,i=new Float32Array([-n/2,-r/2,n/2,-r/2,n/2,r/2,n/2,r/2,-n/2,r/2,-n/2,-r/2]),a=i,o=new Float32Array([0,0,1,0,1,1,1,1,0,1,0,0]),c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);var l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW);var u={normalFilter:se(e,c,l),colorFilter:fe(e,c,l)},s=q(e,2,n,r),f=Object(h.a)(s,2),d=f[0],v=f[1],m=Y(e),p=function(t,o){e.viewport(0,0,t,o),n=t,r=o,Q(e,d),$(e,v);var l=q(e,2,n,r),s=Object(h.a)(l,2);for(var f in d=s[0],v=s[1],i=new Float32Array([-n/2,-r/2,n/2,-r/2,n/2,r/2,n/2,r/2,-n/2,r/2,-n/2,-r/2]),a=i,e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),u){if(u.hasOwnProperty(f))u[f].viewport()}},g=function(o){var l=o[0],s=0;return l?(t||(i=new Float32Array([n/2*l.position.x1,r/2*l.position.y1,n/2*l.position.x2,r/2*l.position.y1,n/2*l.position.x2,r/2*l.position.y2,n/2*l.position.x2,r/2*l.position.y2,n/2*l.position.x1,r/2*l.position.y2,n/2*l.position.x1,r/2*l.position.y1]),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,m),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l.source),e.bindFramebuffer(e.FRAMEBUFFER,d[s%2]),e.useProgram(u.colorFilter.program),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLES,0,6),e.bindTexture(e.TEXTURE_2D,v[s%2]),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),s++,e.bindFramebuffer(e.FRAMEBUFFER,null),u.normalFilter&&e.useProgram(u.normalFilter.program),e.drawArrays(e.TRIANGLES,0,6),[~~(n/2*(l.position.x1+1)),~~(r/2*(l.position.y1+1)),~~(n/2*(l.position.x2+1)),~~(r/2*(l.position.y2+1))]):[]};return{render:g,viewport:p}},ve=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=document.createElement("canvas");r.width=e,r.height=t,r.style.width="100%",r.style.height="100%";var i=r.getContext("webgl",{premultipliedAlpha:!1,alpha:!1,antialias:!0});if(!i)return null;var a=de(i,n),o=function(e,t){r.width=e,r.height=t,a.viewport(e,t)};return{renderer:a,canvasElement:r,gl:i,viewport:o}},me=n(25),he=n.n(me);function pe(){var e=Object(v.a)(["\n    position: absolute;\n"]);return pe=function(){return e},e}var ge=m.a.div(pe()),be=function(){var e=Object(c.useContext)(w);e.state,e.dispatch;return l.a.createElement(ge,null)};function Ee(){var e=Object(v.a)(["\n    position: relative;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n"]);return Ee=function(){return e},e}function we(){var e=Object(v.a)(["\n    //min-width: 100px;\n    display: block;\n    padding: 10px;\n    margin: 20px auto;\n    border-radius: 10px;\n    background: #333;\n"]);return we=function(){return e},e}function xe(){var e=Object(v.a)(["\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    overflow: hidden;\n"]);return xe=function(){return e},e}var ye=new he.a,_e=m.a.div(xe()),Re=m.a.button(we()),Te=m.a.div(Ee());ye.onmessage=function(e){var t=e.data;Ae.draw(t[0],t[1],t[2])};var Ae=function(e,t){var n=document.createElement("canvas");n.classList.add("histogram"),n.width=e,n.height=t;var r=n.getContext("2d");M(n,(function(e){}),(function(e){console.log("move")}));return{draw:function(n,i,a){var o=e/256;if(r){r.globalCompositeOperation="lighter",r.fillStyle="#ff0000",r.clearRect(0,t-0,e,t),r.beginPath(),r.moveTo(0,t-0);for(var c=0;c<n.length;c++)r.lineTo(c*o,t-n[c]);r.lineTo(e,t-0),r.closePath(),r.fill(),r.fillStyle="#00ff00",r.beginPath(),r.moveTo(0,t-0);for(var l=0;l<i.length;l++)r.lineTo(l*o,t-i[l]);r.lineTo(e,t-0),r.closePath(),r.fill(),r.fillStyle="#0000ff",r.beginPath(),r.moveTo(0,t-0);for(var u=0;u<a.length;u++)r.lineTo(u*o,t-a[u]);r.lineTo(e,t-0),r.closePath(),r.fill()}},canvasElement:n}}(360,150),Oe=ve(window.devicePixelRatio*window.innerWidth,window.devicePixelRatio*(window.innerHeight-92)),Ce=ve(300,200,!0),Fe=function(){var e=Object(c.useContext)(w),t=e.state,n=e.dispatch,i=y((function(e){if(/\.png$/.test(e.name)||/\.jpe?g$/.test(e.name)||/\.bmp$/.test(e.name)){var t=document.createElement("img"),r=URL.createObjectURL(e);t.onload=function(){var e;n({type:a.addLayer,payload:(e=t,{editStatus:o.none,source:e,position:{x1:0,y1:0,x2:1,y2:1},originPosition:{x1:0,y1:0,x2:1,y2:1},transform:{left:0,right:0,top:0,bottom:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0,rotate:0},color:{temperature:0,tint:0}})}),n({type:a.updateCanvasSize,payload:{width:t.width,height:t.height}}),URL.revokeObjectURL(r)},t.src=r}})).input,u=Object(c.useRef)(document.createElement("div"));document.createElement("canvas").getContext("2d");Object(c.useEffect)((function(){if(null!==u.current){var e=u.current;if(Oe&&e){e.appendChild(Oe.canvasElement),e.appendChild(Ae.canvasElement);var r=Oe.renderer.render(t.layers),i=Object(h.a)(r,4),o=i[0],c=i[1],l=i[2],s=i[3];if(void 0!==o){var f=new Uint8ClampedArray((l-o)*(s-c)*4);if(Oe.gl.readPixels(o,c,l-o,s-c,Oe.gl.RGBA,Oe.gl.UNSIGNED_BYTE,f),t.savePicture&&Ce){console.log(t),Ce.canvasElement.width===t.width&&Ce.canvasElement.height===t.height||Ce.viewport(t.width,t.height),Ce.renderer.render(t.layers);var d=Ce.canvasElement.toDataURL(),v=document.createElement("a");v.href=d,v.download="\u4fdd\u5b58\u56fe\u7247.png",v.click(),n({type:a.finishSavePicture,payload:null})}ye.postMessage([f,Ae.canvasElement.height],[f.buffer])}}}}));var s=l.a.createElement("div",null,l.a.createElement(Re,{onClick:function(){i.click()}},"\u6253\u5f00\u7167\u7247"),l.a.createElement(Re,null,"\u6253\u5f00\u6837\u672c\u7167\u7247")),f=l.a.createElement(Te,{ref:u},t.layers[0]&&t.layers[0].editStatus===o.none?l.a.createElement(be,null):null),d=t.editStatus===r.IDLE?s:f;return l.a.createElement(_e,null,d)};function Le(){var e=Object(v.a)(["\n    display: flex;\n    flex-direction: column;\n    width: 100vw;\n    height: 100vh;\n    background: #000;\n"]);return Le=function(){return e},e}var je=m.a.div(Le()),Pe=function(e){return l.a.createElement(je,null,l.a.createElement(O,null),l.a.createElement(Fe,null),l.a.createElement(ue,null))};d.a.setAppElement(document.body);var Be=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(x,null,l.a.createElement(Pe,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.0c6b7312.chunk.js.map